% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/limma_model_d.R
\name{limma_model_d}
\alias{limma_model_d}
\title{Run a limma model on an expressionset and formula}
\usage{
limma_model_d(x, d, isFormula = FALSE)
}
\arguments{
\item{x}{ExpressionSet (can be created with make_filtered_eset)}

\item{d}{design matrix or a formula to be used to create one.}

\item{isFormula}{boolean specifying if d is a design matrix (isFormula=FALSE) or a formula (default=FALSE)}
}
\value{
MArrayLM object ("fit")
}
\description{
Reads an expression set and formula
 and runs the model design, fits the model, and runs eBayes.  
 Returns the MArrayLM object ("fit")
 
 If d is a design matrix, it will be input directly into limma:fit
 If d is a formula (set isFormula = TRUE), a design matrix will be created using model.matrix(f)
}
\examples{
dfList <- load_RawCountsGroup(counts_file = file.path(dir_data, file_data), 
                              groups_file = file.path(dir_data, file_groups))
raw <- dfList[[1]]
groupsDF <- dfList[[2]]
rm(dfList)
names(covar_levels) <- covars
covarMtx <- factordf_to_mtx(groupsDF[, covars], cnames=covars, clevels=covar_levels)
eset <- make_filtered_eset(x=raw, y=covarMtx, g=groupsDF$Group, 
                           minc = filter_minCPM, mins = filter_minSampleCount, 
                           nmethod="quantile")
Genotype <- covarMtx[,"Genotype"]
Treatment <- covarMtx[, "Treatment"]
myF <- as.formula("~ Genotype + Treatment")
myFit <- limma_model(x=eset, f=myF)

}
\author{
Susan Huse \email{susan.huse@nih.gov}
}
\keyword{Pipeliner}
\keyword{RNASeq}
\keyword{limma}
